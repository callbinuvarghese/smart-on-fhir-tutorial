<!DOCTYPE html>
<html>
 <head>
    <!--script src="node_modules/fhirclient/fhir-client.js"></script-->
     <script src='./lib/js/fhir-client-v0.1.12.js'></script>
 </head>
 <body>
    <br>
    <span id="name">Loading Patient Namr...</span></h1>
    </br><br>
    <span id="dob">Loading Patient DOB...</span></h1>
    </br><br>
    <span id="gender">Loading Patient Gender...</span></h1>
    </br><br>

    <script type="text/javascript">
        function getPatientName(pt) {
            if (pt.name) {
                var names = pt.name.map(function(name) {
                    return name.given.join(" ") + " " + name.family.join(" ");
                });
                return names.join(" / ");
            } else {
                return "anonymous";
            }
        }
        
        function displayPatient (pt) {
            document.getElementById('name').innerHTML = getPatientName(pt);
        }

        function displayPatientDOB(pt) {
            if (pt.birthDate) {
                document.getElementById("dob").innerHTML = pt.birthDate.toString();
            } else {
                echo("Could not get DOB");
            }
        }
        function displayPatientGender(pt) {
            if (pt.gender) {
                document.getElementById("gender").innerHTML = pt.gender.toString();
            } else {
                echo("Could not get DOB");
            }
        }
      
        FHIR.oauth2.ready(function(smart) {
            smart.patient.read().then(function(pt) {
                displayPatient (pt);
                displayPatientDOB(pt);
                displayPatientGender(pt);
            });
           
        });

    </script>
 </body>
</html>
